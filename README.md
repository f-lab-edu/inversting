# investing

## 개요

- 본 프로젝트는 모의 주식투자 서비스를 제공합니다.
- 코스콤 API를 사용하여, 실제 주식 시세만 가져오며, 주식을 사고 파는 경험을 할 수 있게 해줍니다.

## 기술 스택

- JDK 17
- Spring Boot, Spring Batch, JPA
- Redis
- Kafka
- Mysql
- gradle
- intelliJ

## Use Case

### 공통 사항

주식의 등락폭을 조절하기 위해 몇가지 룰을 추가한다.

- 주식 종목에서 종가 기준 30% 내리거나 오르면, 일일 하루 정지. (상한가, 하한가)
- 20% 오르거나 내려가면, 2분간 하나의 가격으로 살수 있음. (VI)
- 코스피/ 코스닥이 하루에 10% 내려가거나 올라가면 20분간 거래 중지
- 30분안에 20%가 오르면, 에러발생 3일간 30분 단위 거래

---

### 메인 화면

#### 일반 회원일떄

1. 코스피, 코스닥 현재 지수를 보여준다.
2. 제일 많이 하고 있는 종목 5개를 보여준다. (1시간마다 변경)
3. 관심목록에 주식과 현재 가격을 보여준다.  
    3-1. 관심목록없을시, ```관심목록을 추가해주세요``` 문구 응답
3. 현재 가지고 있는 주식 목록 (가격, 등락폭) 보여준다.
4. 현재 자산을 보여준다.

#### 비회원일때

1. 코스피, 코스닥 현재 지수를 보여준다.
2. 메인 화면 이외의 화면에서는 ```로그인 후 진행해주세요``` 문구 응답

---

### 회원가입 - 신규

1. 아이디, 비밀번호, 생년월일, 이름을 입력받도록 한다.  
  1.1 아이디는 이메일형식 (본인인증을 위해)  
  1.2 비밀번호는 8 이상 특수문자 1개 포함  
2. 아이디(이메일)로 인증 메일을 보내고, 인증 후, 로그인이 가능하다.


---

### 로그인

1. 메인화면에서 로그인 버튼 클릭시, 로그인 창 이동  
   1-1. 휴먼상태(6개월 이상 접속 안한 상태) 일경우, 이메일 인증 후, 사용가능

---

### 주식 거래

#### 구매

1. 메인 화면에서 관심 주식이나, 주식을 검색
2. 주식 상세정보를 보여준다.
3. 구매 버튼을 클릭하여, 구매할 주와 ```시장가``` 또는 ```원하는 금액```을 입력한다.  
   3-1. VI 상태 일때는, 금액은 하나로만 살수 있음.
   3-2. 금액 부족시, 잔액 충전후 이동해달라고 응답
   3-3. 종가 기준 30% 오르거나 내려간 상품이면 결제불가
4. 현재 가지고 있는 주식목록에 ```구매 대기``` 상태로 올라간다.
   4-1. 단기과열완화상태일 경우면, 30분마다, 구매대기 상태로 변경 그 전에는 ```과열 상태``` 라고 표시
5. 구매한 돈은 등급별로 수수료를 매긴다. (VIP: 0%, 일반 고객: 0.015%)

#### 판매

1. 현재 가지고 있는 주식목록에 ```구매 대기``` 상태 제품을 클릭한다.
2. 구매 취소를 누리면 예약 테이블에서 DELETE 상태 코드가 변경이 된다.
    2-1. 취소하는 사이에 구매가 되면, 취소는 되지 않는다.

#### 관심종목 추가

1. 메인화면에서, 주식검색을 한다.
2. 주식 상세보기 화면에서, 관심종목 추가 버튼 클릭시, 관심 종목으로 추가가된다.  
   2-1. 상세보기 화면에서 관심종목 추가 버튼이 제거 버튼으로 변경된다.  
   2-2. 제거 버튼 클릭시, 종목에서 제거 된다.

---

### 관리자

#### 로그인

1. 로그인 권한을 가진 아이디로 로그인한다.
2. Google OTP 인증후, 로그인이된다.
   1. 최초 admin은 OTP 등록 후 로그인을 재시도한다.
3. 일일 거래량, 거래 금액을 확인할 수 있다.
4. 주식 검색 기능, 관리자 추가 버튼 기능

#### 주식 상태 변경

1. 메인 화면에서 주식 검색을 한다.
2. 상세 화면으로 이동후, 거래 상태를 변경을 할 수 있다.
   2-1. 거래정지: 거래가 정지 상태로 변경  
   2-2. 정상:     정상적인 상태
   2-3. VI 발동:  2분간 하나의 가격으로만 살 수 있음
   2-4. 단기과열완화상태 : 30분단위로 거래 가능

#### 관리자 추가

1. 관리자 추가 버튼 클릭 시, 일반회원에게 관리자 권한을 줄 수 있다.
2. 최초 관리자 접속시, OTP 등록 후 로그인
